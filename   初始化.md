```bash

conda create --name mahjong python=3.9

pip install torchaudio==0.10.1 -f https://download.pytorch.org/whl/cu111/torch_stable.html
pip install torchvision==0.10.1+cu111 -f https://download.pytorch.org/whl/torch_stable.html

pip install torch==1.9.0+cu111 torchvision==0.10.0+cu111 torchaudio==0.9.0 -f https://download.pytorch.org/whl/torch_stable.html

conda install pytorch torchvision torchaudio cudatoolkit=11.1 -c pytorch -c nvidia
conda install pytorch torchvision torchaudio cudatoolkit=11.1 -c pytorch-lts -c conda-forge

conda install pytorch torchvision torchaudio cpuonly -c pytorch

conda uninstall pytorch
conda uninstall libtorch
pip uninstall pytorch

conda install pytorch torchvision torchaudio pytorch-cuda=11.8 -c pytorch-nightly -c nvidia

%windir%\System32\cmd.exe "/K" G:\miniConda3\Scripts\activate.bat G:\miniConda3
%windir%\System32\WindowsPowerShell\v1.0\powershell.exe -ExecutionPolicy ByPass -NoExit -Command "& 'G:\miniConda3\shell\condabin\conda-hook.ps1' ; conda activate 'G:\miniConda3' "
```

```
docker run -i --rm mortal 2

conda install pytorch torchvision torchaudio pytorch-cuda -c pytorch-nightly -c nvidia
certutil -hashfile ./train_model/mortal.pth MD5


cd L:\Project\majong\Mortal\mortal

tensorboard --logdir=train_model/dir

```

```python
import torch
state = torch.load('./train_model/mortal.pth', map_location=torch.device('cuda'))
torch.save(state, './train_model/mortal.pth')

state = torch.load('./train_model/challenger.pth', map_location=torch.device('cpu'))

version = 3

state = {
    'mortal': mortal.state_dict(),
    'current_dqn': current_dqn.state_dict(),
    'next_rank_pred': next_rank_pred.state_dict(),
    'optimizer': optimizer.state_dict(),
    'scheduler': scheduler.state_dict(),
    'scaler': scaler.state_dict(),
    'steps': steps,
    'timestamp': datetime.now().timestamp(),
    'best_perf': best_perf,
    'config': config,
}
torch.save(state, state_file)


```

```text


L:\Project\majong\akochan_ui-master\tenhou_mjailog/2020\20200101\2020010100gm-00a9-0000-feebf9a4.json.gz

```

```python
from dataloader import *
file_path = 'L:\\Project\\majong\\akochan_ui-master\\tenhou_mjailog/2020/20200101/2020010100gm-00a9-0000-45ea0ff1.json.gz'
file_list = [file_path]

file_data = FileDatasetsIter(version=3, file_list=[file_path], pts=1)
list(file_data.load_files(False))

file_data.loader.load_gz_log_files(file_list)




```

```python

import glob
import gzip
import shutil
from pathlib import Path

globs = [
    'L:\\Project\\majong\\akochan_ui-master\\tenhou_mjailog/2020/**/*.json.gz',
    'L:\\Project\\majong\\akochan_ui-master\\tenhou_mjailog/2021/**/*.json.gz'
]

file_list = []
for pattern in globs:
    items = glob.glob(pattern)
    file_list.extend(items)

total = len(file_list)
index = 0
failed_count = 0
failed_list = []
for file in file_list:
    index += 1
    print("%d/%d" % (index, total))
    try:
        with gzip.open(file, 'rt', encoding='utf-8') as f_in:
            f_in.read()
    except UnicodeDecodeError as e:                
        failed_count += 1
        failed_list.append(file)
                
total = len(failed_list)
index = 0
failed_count = 0
for file in failed_list:
    index += 1
    print("%d/%d" % (index, total))
    with open(file.replace(".gz", ""), 'rb') as f_in:
        with gzip.open(file, 'wb') as f_out:
            content = f_in.read()
            content = content.decode('unicode_escape').encode("utf8")
            f_out.write(content)

            
    

```

```bash

L:
cd L:\Project\majong\majsoul_wrapper-master

mitmdump -s addons.py --set validate_inbound_headers=false

```